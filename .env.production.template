# ============================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ============================================
# This template documents all required environment variables for Railway deployment.
# Railway will automatically provide DATABASE_URL and REDIS_URL.
# Copy this file and set the values in Railway's environment variable settings.

# ============================================
# SERVER CONFIGURATION
# ============================================
NODE_ENV=production
PORT=3000
API_VERSION=v1

# ============================================
# DATABASE CONFIGURATION
# ============================================
# Railway provides DATABASE_URL automatically when PostgreSQL plugin is added
# Format: postgresql://user:password@host:port/database
DATABASE_URL=${DATABASE_URL}

# Individual database connection parameters (Railway provides these)
DB_HOST=${PGHOST}
DB_PORT=${PGPORT}
DB_NAME=${PGDATABASE}
DB_USER=${PGUSER}
DB_PASSWORD=${PGPASSWORD}

# Connection pooling settings (optimized for Railway)
# Railway free tier: limit max connections to 5
# Adjust based on your Railway plan limits
DB_POOL_MIN=2
DB_POOL_MAX=5

# ============================================
# REDIS CONFIGURATION
# ============================================
# Railway provides REDIS_URL automatically when Redis plugin is added
# Format: redis://default:password@host:port
REDIS_URL=${REDIS_URL}

# Individual Redis connection parameters (Railway provides these)
REDIS_HOST=${REDIS_HOST}
REDIS_PORT=${REDIS_PORT}
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DB=0

# ============================================
# SECURITY - REQUIRED: GENERATE SECURE VALUES
# ============================================
# Generate secure random strings for these values
# Use: openssl rand -base64 32
JWT_SECRET=CHANGE_ME_GENERATE_SECURE_RANDOM_STRING
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d
JWT_ISSUER=government-lending-crm
JWT_AUDIENCE=government-lending-crm-api
ENCRYPTION_KEY=CHANGE_ME_GENERATE_SECURE_RANDOM_STRING
BCRYPT_ROUNDS=12

# TLS Configuration (Railway handles HTTPS automatically)
TLS_ENABLED=false

# Key Management
KEY_MANAGEMENT_PROVIDER=local
KEY_MANAGEMENT_KEY_ID=encryption-key
KEY_ROTATION_DAYS=90

# ============================================
# DEMO MODE CONFIGURATION
# ============================================
DEMO_MODE_ENABLED=true
USE_MOCK_SERVICES=true

# ============================================
# EXTERNAL SERVICES - MOCK FOR MVP
# ============================================
# EIN Verification (Mock for MVP)
USE_MOCK_EIN_VERIFICATION=true
EIN_VERIFICATION_API_URL=https://api.example.com/ein
EIN_VERIFICATION_API_KEY=not-required-for-mock

# Email Service (Mock for MVP - logs to console)
USE_MOCK_EMAIL=true
EMAIL_SERVICE_PROVIDER=sendgrid
EMAIL_API_KEY=not-required-for-mock
EMAIL_FROM=noreply@demo.example.com

# Microsoft Teams Integration (Mock for MVP - logs to console)
USE_MOCK_TEAMS=true
TEAMS_CLIENT_ID=not-required-for-mock
TEAMS_CLIENT_SECRET=not-required-for-mock
TEAMS_TENANT_ID=not-required-for-mock
TEAMS_WEBHOOK_SECRET=CHANGE_ME_GENERATE_SECURE_RANDOM_STRING

# ============================================
# AI SERVICES - REAL API KEYS REQUIRED
# ============================================
# LLM Provider Configuration
# Set to 'openai' or 'claude' based on which service you're using
LLM_PROVIDER=openai

# OpenAI Configuration (REQUIRED if LLM_PROVIDER=openai)
OPENAI_API_KEY=REQUIRED_ADD_YOUR_OPENAI_API_KEY
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=2000
OPENAI_TEMPERATURE=0.7
OPENAI_TIMEOUT=30000

# Claude Configuration (REQUIRED if LLM_PROVIDER=claude)
CLAUDE_API_KEY=OPTIONAL_ADD_YOUR_CLAUDE_API_KEY
CLAUDE_MODEL=claude-3-sonnet-20240229
CLAUDE_MAX_TOKENS=2000

# Azure AI Document Intelligence (Optional - gracefully degrades if not provided)
AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT=
AZURE_DOCUMENT_INTELLIGENCE_KEY=
AZURE_DOCUMENT_INTELLIGENCE_TIMEOUT=30000

# AI Service Configuration
AI_CONFIDENCE_THRESHOLD=0.85
AI_MAX_RETRIES=3
AI_RETRY_DELAY=1000

# ============================================
# STORAGE CONFIGURATION
# ============================================
# For MVP, using local file storage
STORAGE_PROVIDER=local
STORAGE_BUCKET=lending-crm-documents
STORAGE_REGION=us-east-1

# ============================================
# CORS CONFIGURATION
# ============================================
# Set to your Railway deployment URL
# Example: https://your-app.railway.app
# Multiple origins can be separated by comma
CORS_ORIGIN=${RAILWAY_PUBLIC_DOMAIN}
# CORS_ORIGIN=https://your-app.railway.app,https://custom-domain.com

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=info

# ============================================
# RAILWAY-SPECIFIC VARIABLES
# ============================================
# These are automatically provided by Railway
# RAILWAY_ENVIRONMENT=production
# RAILWAY_PROJECT_ID=<auto-generated>
# RAILWAY_SERVICE_ID=<auto-generated>
# RAILWAY_DEPLOYMENT_ID=<auto-generated>
# RAILWAY_PUBLIC_DOMAIN=<auto-generated>

# ============================================
# DEPLOYMENT CHECKLIST
# ============================================
# Before deploying, ensure you have:
# ✓ Generated secure JWT_SECRET (openssl rand -base64 32)
# ✓ Generated secure ENCRYPTION_KEY (openssl rand -base64 32)
# ✓ Added your OpenAI or Claude API key
# ✓ Set CORS_ORIGIN to your Railway domain
# ✓ Verified DEMO_MODE_ENABLED=true for MVP
# ✓ Verified USE_MOCK_EMAIL=true and USE_MOCK_TEAMS=true
# ✓ Added PostgreSQL plugin in Railway
# ✓ Added Redis plugin in Railway
